---
// src/pages/architecture.astro
import BaseLayout from "../layouts/BaseLayout.astro";
---

<BaseLayout title="Corrison Architecture">
  <main class="container mx-auto px-4 py-8 max-w-6xl">
    <h1 class="text-3xl font-bold mb-6 text-center">
      Corrison Platform Architecture
    </h1>

    <div class="bg-white p-6 rounded-lg shadow-md mb-8">
      <p class="text-lg mb-4">
        The Corrison platform is a modular, API-first e-commerce and CMS backend
        built with Django and Django REST Framework, powering multiple websites
        with a shared API infrastructure.
      </p>

      <!-- SVG Diagram with responsive container -->
      <div class="w-full overflow-x-auto bg-gray-50 p-4 rounded-lg">
        <div class="w-full min-w-[320px]">
          <svg
            class="w-full h-auto"
            viewBox="0 0 1000 700"
            xmlns="http://www.w3.org/2000/svg"
            preserveAspectRatio="xMidYMid meet"
          >
            <!-- Background -->
            <rect width="1000" height="700" fill="#f8fafc" rx="10" ry="10"
            ></rect>

            <!-- Title -->
            <text
              x="500"
              y="40"
              font-family="sans-serif"
              font-size="24"
              font-weight="bold"
              text-anchor="middle"
              fill="#1e293b"
              >Corrison - Headless E-commerce &amp; CMS Architecture</text
            >

            <!-- Client Layer -->
            <rect
              x="50"
              y="80"
              width="900"
              height="100"
              rx="10"
              ry="10"
              fill="#f0f9ff"
              stroke="#bae6fd"
              stroke-width="2"></rect>
            <text
              x="500"
              y="105"
              font-family="sans-serif"
              font-size="16"
              font-weight="bold"
              text-anchor="middle"
              fill="#0369a1">Client Layer</text
            >

            <!-- Client Components -->
            <rect
              x="100"
              y="120"
              width="180"
              height="40"
              rx="6"
              ry="6"
              fill="#dbeafe"
              stroke="#93c5fd"
              stroke-width="2"></rect>
            <text
              x="190"
              y="144"
              font-family="sans-serif"
              font-size="12"
              text-anchor="middle"
              fill="#2563eb">E-commerce Frontend (Astro.js)</text
            >

            <rect
              x="310"
              y="120"
              width="180"
              height="40"
              rx="6"
              ry="6"
              fill="#dbeafe"
              stroke="#93c5fd"
              stroke-width="2"></rect>
            <text
              x="400"
              y="144"
              font-family="sans-serif"
              font-size="12"
              text-anchor="middle"
              fill="#2563eb">CMS Frontend (Astro.js)</text
            >

            <rect
              x="520"
              y="120"
              width="180"
              height="40"
              rx="6"
              ry="6"
              fill="#dbeafe"
              stroke="#93c5fd"
              stroke-width="2"></rect>
            <text
              x="610"
              y="144"
              font-family="sans-serif"
              font-size="12"
              text-anchor="middle"
              fill="#2563eb">LinkHub Frontend (Astro.js)</text
            >

            <rect
              x="730"
              y="120"
              width="120"
              height="40"
              rx="6"
              ry="6"
              fill="#dbeafe"
              stroke="#93c5fd"
              stroke-width="2"></rect>
            <text
              x="790"
              y="144"
              font-family="sans-serif"
              font-size="12"
              text-anchor="middle"
              fill="#2563eb">3rd Party API Clients</text
            >

            <!-- API Gateway Layer -->
            <rect
              x="50"
              y="210"
              width="900"
              height="80"
              rx="10"
              ry="10"
              fill="#f0fdf4"
              stroke="#bbf7d0"
              stroke-width="2"></rect>
            <text
              x="500"
              y="235"
              font-family="sans-serif"
              font-size="16"
              font-weight="bold"
              text-anchor="middle"
              fill="#166534">API Gateway Layer</text
            >

            <!-- Gateway Components -->
            <rect
              x="160"
              y="250"
              width="180"
              height="30"
              rx="6"
              ry="6"
              fill="#dcfce7"
              stroke="#86efac"
              stroke-width="2"></rect>
            <text
              x="250"
              y="270"
              font-family="sans-serif"
              font-size="12"
              text-anchor="middle"
              fill="#166534">Passenger WSGI</text
            >

            <rect
              x="400"
              y="250"
              width="180"
              height="30"
              rx="6"
              ry="6"
              fill="#dcfce7"
              stroke="#86efac"
              stroke-width="2"></rect>
            <text
              x="490"
              y="270"
              font-family="sans-serif"
              font-size="12"
              text-anchor="middle"
              fill="#166534">CORS Middleware</text
            >

            <rect
              x="640"
              y="250"
              width="180"
              height="30"
              rx="6"
              ry="6"
              fill="#dcfce7"
              stroke="#86efac"
              stroke-width="2"></rect>
            <text
              x="730"
              y="270"
              font-family="sans-serif"
              font-size="12"
              text-anchor="middle"
              fill="#166534">JWT Authentication</text
            >

            <!-- Django REST Layer -->
            <rect
              x="50"
              y="320"
              width="900"
              height="90"
              rx="10"
              ry="10"
              fill="#eff6ff"
              stroke="#bfdbfe"
              stroke-width="2"></rect>
            <text
              x="500"
              y="345"
              font-family="sans-serif"
              font-size="16"
              font-weight="bold"
              text-anchor="middle"
              fill="#1e40af">API Layer (Django REST Framework)</text
            >

            <!-- API Endpoints -->
            <rect
              x="100"
              y="360"
              width="100"
              height="30"
              rx="6"
              ry="6"
              fill="#dbeafe"
              stroke="#93c5fd"
              stroke-width="2"></rect>
            <text
              x="150"
              y="380"
              font-family="sans-serif"
              font-size="12"
              text-anchor="middle"
              fill="#1e40af">Products API</text
            >

            <rect
              x="220"
              y="360"
              width="100"
              height="30"
              rx="6"
              ry="6"
              fill="#dbeafe"
              stroke="#93c5fd"
              stroke-width="2"></rect>
            <text
              x="270"
              y="380"
              font-family="sans-serif"
              font-size="12"
              text-anchor="middle"
              fill="#1e40af">Cart API</text
            >

            <rect
              x="340"
              y="360"
              width="100"
              height="30"
              rx="6"
              ry="6"
              fill="#dbeafe"
              stroke="#93c5fd"
              stroke-width="2"></rect>
            <text
              x="390"
              y="380"
              font-family="sans-serif"
              font-size="12"
              text-anchor="middle"
              fill="#1e40af">Checkout API</text
            >

            <rect
              x="460"
              y="360"
              width="100"
              height="30"
              rx="6"
              ry="6"
              fill="#dbeafe"
              stroke="#93c5fd"
              stroke-width="2"></rect>
            <text
              x="510"
              y="380"
              font-family="sans-serif"
              font-size="12"
              text-anchor="middle"
              fill="#1e40af">Blog API</text
            >

            <rect
              x="580"
              y="360"
              width="100"
              height="30"
              rx="6"
              ry="6"
              fill="#dbeafe"
              stroke="#93c5fd"
              stroke-width="2"></rect>
            <text
              x="630"
              y="380"
              font-family="sans-serif"
              font-size="12"
              text-anchor="middle"
              fill="#1e40af">Pages API</text
            >

            <rect
              x="700"
              y="360"
              width="100"
              height="30"
              rx="6"
              ry="6"
              fill="#dbeafe"
              stroke="#93c5fd"
              stroke-width="2"></rect>
            <text
              x="750"
              y="380"
              font-family="sans-serif"
              font-size="12"
              text-anchor="middle"
              fill="#1e40af">LinkHub API</text
            >

            <rect
              x="820"
              y="360"
              width="100"
              height="30"
              rx="6"
              ry="6"
              fill="#dbeafe"
              stroke="#93c5fd"
              stroke-width="2"></rect>
            <text
              x="870"
              y="380"
              font-family="sans-serif"
              font-size="12"
              text-anchor="middle"
              fill="#1e40af">User API</text
            >

            <!-- Django Application Layer -->
            <rect
              x="50"
              y="440"
              width="900"
              height="110"
              rx="10"
              ry="10"
              fill="#fef2f2"
              stroke="#fee2e2"
              stroke-width="2"></rect>
            <text
              x="500"
              y="465"
              font-family="sans-serif"
              font-size="16"
              font-weight="bold"
              text-anchor="middle"
              fill="#991b1b">Application Layer (Django)</text
            >

            <!-- Django Apps -->
            <rect
              x="80"
              y="480"
              width="180"
              height="55"
              rx="6"
              ry="6"
              fill="#fee2e2"
              stroke="#fecaca"
              stroke-width="2"></rect>
            <text
              x="170"
              y="500"
              font-family="sans-serif"
              font-size="12"
              font-weight="bold"
              text-anchor="middle"
              fill="#991b1b">E-commerce</text
            >
            <text
              x="170"
              y="520"
              font-family="sans-serif"
              font-size="10"
              text-anchor="middle"
              fill="#991b1b">products, cart, checkout</text
            >

            <rect
              x="280"
              y="480"
              width="180"
              height="55"
              rx="6"
              ry="6"
              fill="#fee2e2"
              stroke="#fecaca"
              stroke-width="2"></rect>
            <text
              x="370"
              y="500"
              font-family="sans-serif"
              font-size="12"
              font-weight="bold"
              text-anchor="middle"
              fill="#991b1b">Content</text
            >
            <text
              x="370"
              y="520"
              font-family="sans-serif"
              font-size="10"
              text-anchor="middle"
              fill="#991b1b">blog, pages</text
            >

            <rect
              x="480"
              y="480"
              width="180"
              height="55"
              rx="6"
              ry="6"
              fill="#fee2e2"
              stroke="#fecaca"
              stroke-width="2"></rect>
            <text
              x="570"
              y="500"
              font-family="sans-serif"
              font-size="12"
              font-weight="bold"
              text-anchor="middle"
              fill="#991b1b">LinkHub</text
            >
            <text
              x="570"
              y="520"
              font-family="sans-serif"
              font-size="10"
              text-anchor="middle"
              fill="#991b1b">links, link categories</text
            >

            <rect
              x="680"
              y="480"
              width="250"
              height="55"
              rx="6"
              ry="6"
              fill="#fee2e2"
              stroke="#fecaca"
              stroke-width="2"></rect>
            <text
              x="805"
              y="500"
              font-family="sans-serif"
              font-size="12"
              font-weight="bold"
              text-anchor="middle"
              fill="#991b1b">Core</text
            >
            <text
              x="805"
              y="520"
              font-family="sans-serif"
              font-size="10"
              text-anchor="middle"
              fill="#991b1b">accounts, authentication, api, core</text
            >

            <!-- Infrastructure Layer -->
            <rect
              x="50"
              y="580"
              width="900"
              height="100"
              rx="10"
              ry="10"
              fill="#f5f3ff"
              stroke="#ddd6fe"
              stroke-width="2"></rect>
            <text
              x="500"
              y="605"
              font-family="sans-serif"
              font-size="16"
              font-weight="bold"
              text-anchor="middle"
              fill="#5b21b6">Infrastructure Layer</text
            >

            <!-- Infrastructure Components -->
            <rect
              x="80"
              y="625"
              width="250"
              height="40"
              rx="6"
              ry="6"
              fill="#ddd6fe"
              stroke="#c4b5fd"
              stroke-width="2"></rect>
            <text
              x="205"
              y="650"
              font-family="sans-serif"
              font-size="12"
              font-weight="bold"
              text-anchor="middle"
              fill="#5b21b6">Database (MariaDB/MySQL)</text
            >

            <rect
              x="350"
              y="625"
              width="250"
              height="40"
              rx="6"
              ry="6"
              fill="#ddd6fe"
              stroke="#c4b5fd"
              stroke-width="2"></rect>
            <text
              x="475"
              y="650"
              font-family="sans-serif"
              font-size="12"
              font-weight="bold"
              text-anchor="middle"
              fill="#5b21b6">Media Storage (Django)</text
            >

            <rect
              x="620"
              y="625"
              width="310"
              height="40"
              rx="6"
              ry="6"
              fill="#ddd6fe"
              stroke="#c4b5fd"
              stroke-width="2"></rect>
            <text
              x="775"
              y="650"
              font-family="sans-serif"
              font-size="12"
              font-weight="bold"
              text-anchor="middle"
              fill="#5b21b6">Static Files (WhiteNoise/cPanel)</text
            >

            <!-- Arrows -->
            <!-- Client to API Gateway -->
            <path
              d="M500,180 L500,210"
              stroke="#64748b"
              stroke-width="2"
              marker-end="url(#arrowhead)"></path>

            <!-- API Gateway to Django REST -->
            <path
              d="M500,290 L500,320"
              stroke="#64748b"
              stroke-width="2"
              marker-end="url(#arrowhead)"></path>

            <!-- Django REST to Application -->
            <path
              d="M500,410 L500,440"
              stroke="#64748b"
              stroke-width="2"
              marker-end="url(#arrowhead)"></path>

            <!-- Application to Infrastructure -->
            <path
              d="M500,550 L500,580"
              stroke="#64748b"
              stroke-width="2"
              marker-end="url(#arrowhead)"></path>

            <!-- Arrowhead definition -->
            <defs>
              <marker
                id="arrowhead"
                markerWidth="10"
                markerHeight="7"
                refX="9"
                refY="3.5"
                orient="auto"
              >
                <polygon points="0 0, 10 3.5, 0 7" fill="#64748b"></polygon>
              </marker>
            </defs>

            <!-- External Integrations -->
            <rect
              x="880"
              y="400"
              width="80"
              height="70"
              rx="6"
              ry="6"
              fill="#ecfdf5"
              stroke="#a7f3d0"
              stroke-width="2"></rect>
            <text
              x="920"
              y="425"
              font-family="sans-serif"
              font-size="10"
              font-weight="bold"
              text-anchor="middle"
              fill="#047857">External</text
            >
            <text
              x="920"
              y="440"
              font-family="sans-serif"
              font-size="10"
              text-anchor="middle"
              fill="#047857">Stripe</text
            >
            <!-- <text
              x="920"
              y="455"
              font-family="sans-serif"
              font-size="10"
              text-anchor="middle"
              fill="#047857">PayPal</text
            > -->

            <!-- Domains -->
            <rect
              x="40"
              y="70"
              width="150"
              height="20"
              rx="5"
              ry="5"
              fill="#fff"
              stroke="#94a3b8"
              stroke-width="1"></rect>
            <text
              x="115"
              y="84"
              font-family="sans-serif"
              font-size="10"
              text-anchor="middle"
              fill="#1e293b">corrisonapi.com (Frontend)</text
            >

            <rect
              x="40"
              y="200"
              width="190"
              height="20"
              rx="5"
              ry="5"
              fill="#fff"
              stroke="#94a3b8"
              stroke-width="1"></rect>
            <text
              x="135"
              y="214"
              font-family="sans-serif"
              font-size="10"
              text-anchor="middle"
              fill="#1e293b">corrison.corrisonapi.com (API)</text
            >
          </svg>
        </div>
      </div>

      <!-- Legend and additional information -->
      <div class="mt-8 grid grid-cols-1 md:grid-cols-2 gap-6">
        <div>
          <h2 class="text-xl font-semibold mb-3">Key Components</h2>
          <ul class="space-y-2">
            <li class="flex items-start">
              <div
                class="w-4 h-4 mt-1 mr-2 bg-blue-100 border border-blue-300 rounded"
              >
              </div>
              <div>
                <span class="font-medium">Client Layer:</span> Various frontends
                consuming the API
              </div>
            </li>
            <li class="flex items-start">
              <div
                class="w-4 h-4 mt-1 mr-2 bg-green-100 border border-green-300 rounded"
              >
              </div>
              <div>
                <span class="font-medium">API Gateway:</span> Request handling and
                authentication
              </div>
            </li>
            <li class="flex items-start">
              <div
                class="w-4 h-4 mt-1 mr-2 bg-blue-100 border border-blue-300 rounded"
              >
              </div>
              <div>
                <span class="font-medium">API Layer:</span> RESTful endpoints for
                each module
              </div>
            </li>
            <li class="flex items-start">
              <div
                class="w-4 h-4 mt-1 mr-2 bg-red-100 border border-red-300 rounded"
              >
              </div>
              <div>
                <span class="font-medium">Application Layer:</span> Core Django functionality
              </div>
            </li>
            <li class="flex items-start">
              <div
                class="w-4 h-4 mt-1 mr-2 bg-purple-100 border border-purple-300 rounded"
              >
              </div>
              <div>
                <span class="font-medium">Infrastructure Layer:</span> Database and
                storage
              </div>
            </li>
          </ul>
        </div>

        <div>
          <h2 class="text-xl font-semibold mb-3">Domains</h2>
          <ul class="space-y-2">
            <li class="flex items-start">
              <div class="w-3 h-3 mt-1 mr-2 rounded-full bg-gray-800"></div>
              <div>
                <span class="font-medium">corrison.corrisonapi.com:</span>
                API endpoints
              </div>
            </li>
            <li class="flex items-start">
              <div class="w-3 h-3 mt-1 mr-2 rounded-full bg-gray-800"></div>
              <div>
                <span class="font-medium">corrisonapi.com:</span> Frontend consuming
                the API
              </div>
            </li>
          </ul>

          <h2 class="text-xl font-semibold mt-6 mb-3">External Services</h2>
          <ul class="space-y-2">
            <li class="flex items-start">
              <div class="w-3 h-3 mt-1 mr-2 rounded-full bg-emerald-600"></div>
              <div>
                <span class="font-medium">Payment Processors:</span> Stripe
              </div>
            </li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Additional Information -->
    <div class="bg-white p-6 rounded-lg shadow-md">
      <h2 class="text-2xl font-bold mb-4">About Corrison Platform</h2>

      <p class="mb-4">
        Corrison is a headless, API-first platform designed to power websites,
        blogs, e-commerce, and more. The modular architecture allows you to
        choose any combination of services:
      </p>

      <ul class="list-disc pl-6 mb-6 space-y-2">
        <li>
          <strong>Products & Store:</strong> Full e-commerce functionality (products,
          carts, orders)
        </li>
        <li>
          <strong>Blog:</strong> Content management for blog posts and categories
        </li>
        <li>
          <strong>Pages:</strong> CMS-powered landing pages with rich content
        </li>
        <li>
          <strong>LinkHub:</strong> Structured "link-in-bio" pages with support for
          various media types
        </li>
      </ul>

      <h3 class="text-xl font-semibold mt-6 mb-3">Key Features</h3>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div class="border border-gray-200 rounded p-4">
          <h4 class="font-medium mb-2">API First Design</h4>
          <p class="text-gray-700">
            RESTful API endpoints for all content and functionality, making it
            completely headless
          </p>
        </div>

        <div class="border border-gray-200 rounded p-4">
          <h4 class="font-medium mb-2">Modular Architecture</h4>
          <p class="text-gray-700">
            Use only the components you need - from full e-commerce to just the
            CMS
          </p>
        </div>

        <div class="border border-gray-200 rounded p-4">
          <h4 class="font-medium mb-2">Flexible Authentication</h4>
          <p class="text-gray-700">
            JWT-based authentication with user management and permissions
          </p>
        </div>

        <div class="border border-gray-200 rounded p-4">
          <h4 class="font-medium mb-2">Optimized Performance</h4>
          <p class="text-gray-700">
            WhiteNoise for static files and efficient Django ORM queries
          </p>
        </div>
      </div>
      <!-- Add this new section after the Key Features grid -->
      <h3 class="text-xl font-semibold mt-8 mb-3">
        Frontends Consuming The Corrison API
      </h3>

      <div class="grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3">
        <div class="border border-gray-200 rounded p-4">
          <h4 class="font-medium mb-2">
            <a
              href="https://www.corrisonapi.com"
              target="_blank"
              class="text-blue-600 hover:text-blue-800"
            >
              corrisonapi.com
            </a>
          </h4>
          <p class="text-gray-700">Consuming Pages, Blog and LinkHub APIs</p>
        </div>

        <div class="border border-gray-200 rounded p-4">
          <h4 class="font-medium mb-2">
            <a
              href="https://www.todiane.com"
              target="_blank"
              class="text-blue-600 hover:text-blue-800"
            >
              todiane.com
            </a>
          </h4>
          <p class="text-gray-700">Consuming the Pages and LinkHub APIs</p>
        </div>

        <div class="border border-gray-200 rounded p-4">
          <h4 class="font-medium mb-2">
            <a href="#" class="text-blue-600 hover:text-blue-800">
              portfolio.corrisonapi.com
            </a>
          </h4>
          <p class="text-gray-700">
            Consuming the LinkHub API <span class="text-xs text-gray-500"
              >(coming soon)</span
            >
          </p>
        </div>

        <div class="border border-gray-200 rounded p-4">
          <h4 class="font-medium mb-2">
            <a href="#" class="text-blue-600 hover:text-blue-800">
              events.corrisonapi.com
            </a>
          </h4>
          <p class="text-gray-700">
            Consuming the Events API <span class="text-xs text-gray-500"
              >(coming soon)</span
            >
          </p>
        </div>

        <div class="border border-gray-200 rounded p-4">
          <h4 class="font-medium mb-2">
            <a href="#" class="text-blue-600 hover:text-blue-800">
              ecommerce.corrisonapi.com
            </a>
          </h4>
          <p class="text-gray-700">
            Consuming the eCommerce and Blog APIs <span
              class="text-xs text-gray-500">(coming soon)</span
            >
          </p>
        </div>
      </div>
    </div>
  </main>
</BaseLayout>
